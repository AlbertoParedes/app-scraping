{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\src\\\\components\\\\ContainerApp\\\\Categorias\\\\PanelPresarank\\\\Card.js\";\nimport React, { Component } from 'react';\nimport { ReactComponent as Logo } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/download-cloud.svg\";\nimport ConfirmAlert from '../../../Global/ConfirmAlert';\nimport { ReactComponent as Trash } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/trash.svg\";\nimport XLSX from 'xlsx';\nimport firebase from '../../../../firebase/Firebase';\nimport moment from 'moment-with-locales-es6';\nvar db = firebase.database().ref();\n\nvar Card =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Card, _Component);\n\n  function Card(props) {\n    var _this;\n\n    _classCallCheck(this, Card);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Card).call(this, props));\n\n    _this.componentWillMount = function () {\n      _this.renderData();\n    };\n\n    _this.componentWillReceiveProps = function (newProps) {\n      if (_this.state.item.id_document !== newProps.item.id_document) {\n        _this.setState({\n          item: newProps.item\n        }, function () {\n          _this.renderData();\n        });\n      }\n    };\n\n    _this.downloadDocument = function () {\n      var periodicosIndividuales = [],\n          blogIndividuales = [],\n          blogsGrupos = [],\n          periodicosGrupos = [];\n\n      _this.state.item.medios.periodicosIndividuales.forEach(function (o) {\n        periodicosIndividuales.push({\n          'NOMBRE': o.name,\n          'URL': o.url,\n          'OFERTA': o.oferta ? 'Si' : 'No',\n          'IDIOMA': o.idioma,\n          'DR': o.dr,\n          'DA': o.da,\n          'PA': o.pa,\n          'CF': o.cf,\n          'TF': o.tf,\n          'RD': o.rd,\n          'PRECIO SIN GRUPO': o.precioSinGrupo\n        });\n      });\n\n      _this.state.item.medios.blogsIndividuales.forEach(function (o) {\n        blogIndividuales.push({\n          'NOMBRE': o.name,\n          'URL': o.url,\n          'OFERTA': o.oferta ? 'Si' : 'No',\n          'IDIOMA': o.idioma,\n          'DR': o.dr,\n          'DA': o.da,\n          'PA': o.pa,\n          'CF': o.cf,\n          'TF': o.tf,\n          'RD': o.rd,\n          'PRECIO SIN GRUPO': o.precioSinGrupo\n        });\n      });\n\n      _this.state.item.medios.gruposPeriodicos.forEach(function (o) {\n        periodicosGrupos.push({\n          'NOMBRE': o.name,\n          'URL': o.url,\n          'OFERTA': o.oferta ? 'Si' : 'No',\n          'DR': o.dr,\n          'DA': o.da,\n          'PA': o.pa,\n          'CF': o.cf,\n          'TF': o.tf,\n          'EM': o.em,\n          'EO': o.eo,\n          'TEMÁTICA': o.tematica,\n          'PRECIO POR PERSONA': o.precioPorPersona\n        });\n      });\n\n      _this.state.item.medios.gruposBlogs.forEach(function (o) {\n        blogsGrupos.push({\n          'NOMBRE': o.name,\n          'URL': o.url,\n          'OFERTA': o.oferta ? 'Si' : 'No',\n          'DR': o.dr,\n          'DA': o.da,\n          'PA': o.pa,\n          'CF': o.cf,\n          'TF': o.tf,\n          'EM': o.em,\n          'EO': o.eo,\n          'TEMÁTICA': o.tematica,\n          'PRECIO POR PERSONA': o.precioPorPersona\n        });\n      });\n\n      var wb = XLSX.utils.book_new();\n      var periodicosIndividualesWS = XLSX.utils.json_to_sheet(periodicosIndividuales);\n      var blogsIndividualesWS = XLSX.utils.json_to_sheet(blogIndividuales);\n      var periodicosGruposWS = XLSX.utils.json_to_sheet(periodicosGrupos);\n      var blogsGruposWS = XLSX.utils.json_to_sheet(blogsGrupos);\n      if (periodicosIndividuales.length > 0) XLSX.utils.book_append_sheet(wb, periodicosIndividualesWS, \"Periodicos (Individual)\");\n      if (blogIndividuales.length > 0) XLSX.utils.book_append_sheet(wb, blogsIndividualesWS, \"Blogs (Individual)\");\n      if (periodicosGrupos.length > 0) XLSX.utils.book_append_sheet(wb, periodicosGruposWS, \"Grupos (periódicos)\");\n      if (blogsGrupos.length > 0) XLSX.utils.book_append_sheet(wb, blogsGruposWS, \"Grupos (blogs)\");\n\n      if (periodicosIndividuales.length > 0 || blogIndividuales.length > 0) {\n        XLSX.writeFile(wb, \"Prensarank Medios.xlsx\");\n      }\n    };\n\n    _this.renderData = function () {\n      var item = _this.state.item;\n      var medios = '',\n          totalMedios = 0;\n      Object.entries(item.medios).some(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            i = _ref2[0],\n            m = _ref2[1];\n\n        if (medios.length < 300) {\n          Object.entries(m).some(function (_ref3) {\n            var _ref4 = _slicedToArray(_ref3, 2),\n                i2 = _ref4[0],\n                m2 = _ref4[1];\n\n            if (medios.length < 300) {\n              medios = medios + m2.name + \", \";\n              return false;\n            } else {\n              return true;\n            }\n          });\n        }\n\n        totalMedios += Object.keys(m).length;\n      });\n      var fecha = moment(item.timestamp);\n      var year = false;\n\n      if (fecha.format('DD/MM/YYYY') === moment().format('DD/MM/YYYY') || fecha.format('DD/MM/YYYY') === moment().subtract(1, 'day').format('DD/MM/YYYY')) {\n        fecha = fecha.locale('es').calendar();\n        fecha = fecha.charAt(0).toUpperCase() + fecha.slice(1);\n      } else {\n        fecha = fecha.locale('es').format('LL');\n        var arrayFecha = fecha.split('de');\n        fecha = arrayFecha[0].trim() + ' de ' + arrayFecha[1].trim().charAt(0).toUpperCase() + arrayFecha[1].trim().slice(1);\n\n        if (arrayFecha[2].trim() !== moment().format('YYYY').toString()) {\n          year = arrayFecha[2].trim();\n        }\n      }\n\n      _this.setState({\n        fecha: fecha,\n        totalMedios: totalMedios,\n        year: year,\n        medios: medios\n      });\n    };\n\n    _this.confirmResult = function (result) {\n      if (result === 'cancelar') {\n        _this.setState({\n          eliminar: false\n        });\n      }\n\n      if (result === 'aceptar') {\n        var multiPath = {};\n        multiPath[\"Others/apps/scraping/prensarank-medios/documents/\".concat(_this.state.item.id_document)] = null;\n        db.update(multiPath).then(function () {\n          _this.setState({\n            eliminar: false\n          });\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }\n    };\n\n    _this.state = {\n      item: _this.props.item,\n      eliminar: false,\n      fecha: false,\n      totalMedios: false,\n      medios: false,\n      year: false\n    };\n    return _this;\n  }\n\n  _createClass(Card, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      if (this.state.item.id_document !== nextProps.item.id_document) {\n        return true;\n      }\n\n      if (this.state.fecha !== nextState.fecha || this.state.totalMedios !== nextState.totalMedios || this.state.medios !== nextState.medios || this.state.year !== nextState.year) {\n        return true;\n      }\n\n      if (this.state.eliminar !== nextState.eliminar) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"Card2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"heading_2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, this.state.fecha)), React.createElement(\"div\", {\n        className: \"display_flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, this.state.totalMedios, \" \", this.state.totalMedios === 1 ? 'Resultado' : 'Resultados'), React.createElement(\"span\", {\n        onClick: function onClick() {\n          return _this2.downloadDocument();\n        },\n        className: \"cloud-ahrefs-keywords \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(Logo, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }), \"Descargar\"), this.state.year ? React.createElement(\"div\", {\n        className: \"year-item-card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, this.state.year) : null), React.createElement(\"div\", {\n        className: \"container-kws\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, this.state.medios), React.createElement(\"div\", {\n        className: \"toolbar-card-ahrefs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"items-toolbara-ahrefs\",\n        onClick: function onClick() {\n          return _this2.setState({\n            eliminar: true\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(Trash, {\n        className: \"btn-ahres-tool trashbutton\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }))), this.state.eliminar ? React.createElement(ConfirmAlert, {\n        text: '¿Estás seguro que deseas eliminar este documento?',\n        cancelar: 'Cancelar',\n        aceptar: 'Eliminar',\n        confirmResult: function confirmResult(result) {\n          return _this2.confirmResult(result);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }) : null);\n    }\n  }]);\n\n  return Card;\n}(Component);\n\nexport default Card;","map":{"version":3,"sources":["C:\\Users\\Alberto\\Documents\\workspaces\\react\\YOSEO-SCRIPTS\\src\\components\\ContainerApp\\Categorias\\PanelPresarank\\Card.js"],"names":["React","Component","ConfirmAlert","XLSX","firebase","moment","db","database","ref","Card","props","componentWillMount","renderData","componentWillReceiveProps","newProps","state","item","id_document","setState","downloadDocument","periodicosIndividuales","blogIndividuales","blogsGrupos","periodicosGrupos","medios","forEach","o","push","name","url","oferta","idioma","dr","da","pa","cf","tf","rd","precioSinGrupo","blogsIndividuales","gruposPeriodicos","em","eo","tematica","precioPorPersona","gruposBlogs","wb","utils","book_new","periodicosIndividualesWS","json_to_sheet","blogsIndividualesWS","periodicosGruposWS","blogsGruposWS","length","book_append_sheet","writeFile","totalMedios","Object","entries","some","i","m","i2","m2","keys","fecha","timestamp","year","format","subtract","locale","calendar","charAt","toUpperCase","slice","arrayFecha","split","trim","toString","confirmResult","result","eliminar","multiPath","update","then","catch","err","console","log","nextProps","nextState"],"mappings":"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","sourcesContent":["import React,{Component} from 'react'\r\nimport { ReactComponent as Logo } from '../../../Global/Images/download-cloud.svg';\r\nimport ConfirmAlert from '../../../Global/ConfirmAlert'\r\nimport { ReactComponent as Trash } from '../../../Global/Images/trash.svg';\r\nimport XLSX from 'xlsx';\r\nimport firebase from '../../../../firebase/Firebase';\r\n\r\nimport moment from 'moment-with-locales-es6'\r\nconst db = firebase.database().ref();\r\nclass Card extends Component{\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state={\r\n      item: this.props.item,\r\n      eliminar: false,\r\n\r\n      fecha:false, \r\n      totalMedios:false, \r\n      medios: false, \r\n      year: false, \r\n    }\r\n  }\r\n\r\n  componentWillMount = () => {\r\n    this.renderData()\r\n  }\r\n\r\n  componentWillReceiveProps = newProps => {\r\n    if(this.state.item.id_document!==newProps.item.id_document){this.setState({item:newProps.item},()=>{this.renderData()})}\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    if (this.state.item.id_document !== nextProps.item.id_document) {\r\n      return true;\r\n    }\r\n    if (this.state.fecha !== nextState.fecha || this.state.totalMedios !== nextState.totalMedios || this.state.medios !== nextState.medios || this.state.year !== nextState.year ) {\r\n      return true;\r\n    }\r\n    if (this.state.eliminar !== nextState.eliminar) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  downloadDocument = () => {\r\n\r\n    var periodicosIndividuales = [], blogIndividuales=[], blogsGrupos=[], periodicosGrupos=[];\r\n\r\n    this.state.item.medios.periodicosIndividuales.forEach((o)=>{\r\n      periodicosIndividuales.push({\r\n        'NOMBRE': o.name,\r\n        'URL':o.url,\r\n        'OFERTA':o.oferta?'Si':'No',\r\n        'IDIOMA':o.idioma,\r\n        'DR':o.dr,\r\n        'DA':o.da,\r\n        'PA':o.pa,\r\n        'CF':o.cf,\r\n        'TF':o.tf,\r\n        'RD':o.rd,\r\n        'PRECIO SIN GRUPO':o.precioSinGrupo\r\n      })\r\n    })\r\n\r\n    this.state.item.medios.blogsIndividuales.forEach((o)=>{\r\n      blogIndividuales.push({\r\n        'NOMBRE': o.name,\r\n        'URL':o.url,\r\n        'OFERTA':o.oferta?'Si':'No',\r\n        'IDIOMA':o.idioma,\r\n        'DR':o.dr,\r\n        'DA':o.da,\r\n        'PA':o.pa,\r\n        'CF':o.cf,\r\n        'TF':o.tf,\r\n        'RD':o.rd,\r\n        'PRECIO SIN GRUPO':o.precioSinGrupo\r\n      })\r\n    })\r\n\r\n    this.state.item.medios.gruposPeriodicos.forEach((o)=>{\r\n      periodicosGrupos.push({\r\n        'NOMBRE': o.name,\r\n        'URL':o.url,\r\n        'OFERTA':o.oferta?'Si':'No',\r\n        'DR':o.dr,\r\n        'DA':o.da,\r\n        'PA':o.pa,\r\n        'CF':o.cf,\r\n        'TF':o.tf,\r\n        'EM':o.em,\r\n        'EO':o.eo,\r\n        'TEMÁTICA':o.tematica,\r\n        'PRECIO POR PERSONA':o.precioPorPersona\r\n      })\r\n    })\r\n\r\n    this.state.item.medios.gruposBlogs.forEach((o)=>{\r\n      blogsGrupos.push({\r\n        'NOMBRE': o.name,\r\n        'URL':o.url,\r\n        'OFERTA':o.oferta?'Si':'No',\r\n        'DR':o.dr,\r\n        'DA':o.da,\r\n        'PA':o.pa,\r\n        'CF':o.cf,\r\n        'TF':o.tf,\r\n        'EM':o.em,\r\n        'EO':o.eo,\r\n        'TEMÁTICA':o.tematica,\r\n        'PRECIO POR PERSONA':o.precioPorPersona\r\n      })\r\n    })\r\n\r\n    var wb = XLSX.utils.book_new();\r\n\r\n    var periodicosIndividualesWS = XLSX.utils.json_to_sheet(periodicosIndividuales);\r\n    var blogsIndividualesWS = XLSX.utils.json_to_sheet(blogIndividuales);\r\n\r\n    var periodicosGruposWS = XLSX.utils.json_to_sheet(periodicosGrupos);\r\n    var blogsGruposWS = XLSX.utils.json_to_sheet(blogsGrupos);\r\n    \r\n    if(periodicosIndividuales.length>0)\r\n      XLSX.utils.book_append_sheet(wb, periodicosIndividualesWS, \"Periodicos (Individual)\");\r\n    \r\n    if(blogIndividuales.length>0)\r\n      XLSX.utils.book_append_sheet(wb, blogsIndividualesWS, \"Blogs (Individual)\");\r\n\r\n    if(periodicosGrupos.length>0)\r\n      XLSX.utils.book_append_sheet(wb, periodicosGruposWS, \"Grupos (periódicos)\");\r\n    \r\n    if(blogsGrupos.length>0)\r\n      XLSX.utils.book_append_sheet(wb, blogsGruposWS, \"Grupos (blogs)\");\r\n     \r\n\r\n\r\n    if(periodicosIndividuales.length>0 || blogIndividuales.length>0){\r\n      XLSX.writeFile(wb, `Prensarank Medios.xlsx`);\r\n    }\r\n    \r\n  }\r\n\r\n  renderData = () => {\r\n    var item = this.state.item;\r\n  \r\n    var medios = '', totalMedios = 0\r\n      Object.entries(item.medios).some(([i, m]) => {\r\n        if (medios.length < 300){\r\n          Object.entries(m).some(([i2, m2]) => {\r\n            if (medios.length < 300){ medios = medios + m2.name + \", \"; return false;\r\n            }else{ return true; }\r\n          })\r\n        }\r\n        totalMedios+=Object.keys(m).length\r\n      });\r\n\r\n\r\n    var fecha = moment(item.timestamp)\r\n    var year = false;\r\n\r\n    if(fecha.format('DD/MM/YYYY')===moment().format('DD/MM/YYYY') || fecha.format('DD/MM/YYYY')===moment().subtract(1, 'day').format('DD/MM/YYYY')){\r\n      fecha = fecha.locale('es').calendar();\r\n      fecha = fecha.charAt(0).toUpperCase() + fecha.slice(1)\r\n    }else{\r\n      fecha = fecha.locale('es').format('LL');\r\n      var arrayFecha = fecha.split('de');\r\n      fecha =  arrayFecha[0].trim()   +' de '+ arrayFecha[1].trim().charAt(0).toUpperCase() + arrayFecha[1].trim().slice(1)\r\n      if(arrayFecha[2].trim()!==moment().format('YYYY').toString()){\r\n        year = arrayFecha[2].trim()\r\n      }\r\n    }\r\n\r\n    this.setState({\r\n      fecha, totalMedios, year, medios\r\n    })\r\n\r\n  }\r\n\r\n  confirmResult = (result) => {\r\n    if(result==='cancelar'){\r\n      this.setState({eliminar:false})\r\n    }if(result==='aceptar'){\r\n      var multiPath = {}\r\n      multiPath[`Others/apps/scraping/prensarank-medios/documents/${this.state.item.id_document}`]=null\r\n      db.update(multiPath)\r\n      .then(()=>{\r\n        this.setState({eliminar:false})\r\n      })\r\n      .catch(err=>{\r\n        console.log(err);\r\n      })\r\n      \r\n    }\r\n\r\n  }\r\n\r\n  render(){\r\n  \r\n\r\n    return (\r\n      <div className='Card2' >\r\n        <div className='heading_2'>\r\n          <span>{this.state.fecha}</span>\r\n        </div>\r\n        {/*<h2>{this.state.fecha}</h2>*/}\r\n        <div className='display_flex'>\r\n          <p>{this.state.totalMedios} {this.state.totalMedios===1?'Resultado':'Resultados'}</p>\r\n          <span onClick={()=>this.downloadDocument()} className='cloud-ahrefs-keywords ' ><Logo />Descargar</span>\r\n          {this.state.year?\r\n            <div className='year-item-card'>{this.state.year}</div>\r\n          :null}\r\n          \r\n        </div>\r\n        <div className='container-kws'>\r\n          {this.state.medios}\r\n        </div>\r\n\r\n        <div className='toolbar-card-ahrefs'>\r\n          <div className='items-toolbara-ahrefs' onClick={()=>this.setState({eliminar:true})}><Trash className='btn-ahres-tool trashbutton' /></div>\r\n        </div>\r\n        \r\n\r\n        {this.state.eliminar ?\r\n          <ConfirmAlert\r\n            text={'¿Estás seguro que deseas eliminar este documento?'}\r\n            cancelar={'Cancelar'}\r\n            aceptar={'Eliminar'}\r\n            confirmResult={(result) => this.confirmResult(result)}\r\n          /> : null\r\n        }\r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nexport default Card"]},"metadata":{},"sourceType":"module"}