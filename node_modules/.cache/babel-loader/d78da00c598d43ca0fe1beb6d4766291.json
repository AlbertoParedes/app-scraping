{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\src\\\\components\\\\ContainerApp\\\\Categorias\\\\PanelAhrefsKeywords\\\\Card.js\";\nimport React, { Component } from 'react';\nimport { ReactComponent as Logo } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/download-cloud.svg\";\nimport { ReactComponent as Play } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/play.svg\";\nimport { ReactComponent as Loop } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/loop.svg\";\nimport { ReactComponent as Check } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/check.svg\";\nimport { ReactComponent as Trash } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/trash.svg\";\nimport ConfirmAlert from '../../../Global/ConfirmAlert';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { setScrapingOpera } from '../../../../redux/actions';\nimport firebase from '../../../../firebase/Firebase';\nimport XLSX from 'xlsx';\nvar db = firebase.database().ref();\n\nvar _window$require = window.require('electron'),\n    ipcRenderer = _window$require.ipcRenderer;\n\nvar Card =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Card, _Component);\n\n  function Card(props) {\n    var _this;\n\n    _classCallCheck(this, Card);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Card).call(this, props));\n\n    _this.goScraping = function () {\n      var keywords = {};\n      Object.entries(_this.props.item.keywords).forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            k = _ref2[0],\n            kwd = _ref2[1];\n\n        if (!kwd.results) {\n          keywords[k] = kwd;\n        }\n      });\n      console.log(keywords);\n      var obj = {\n        item: _this.props.item,\n        os: _this.props.os\n      };\n\n      _this.props.setScrapingOpera(_this.props.item); //ipcRenderer.send('START_SCRAPING_KEYWORDS_AHREFS', JSON.stringify(obj));\n\n    };\n\n    _this.confirmResult = function (result) {\n      if (result === 'cancelar') {\n        _this.setState({\n          eliminar: false\n        });\n      }\n\n      if (result === 'aceptar') {\n        var multiPath = {};\n        multiPath[\"Others/apps/scraping/keywords-explorer-ahrefs/documents/\".concat(_this.props.item.id_document)] = null;\n        db.update(multiPath).then(function () {\n          _this.setState({\n            eliminar: false\n          });\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }\n    };\n\n    _this.handleDowload = function () {\n      var data = [];\n      Object.entries(_this.props.item.keywords).forEach(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            i = _ref4[0],\n            o = _ref4[1];\n\n        var row = {};\n        row['KEYWORD'] = o.keyword;\n        o.results.forEach(function (o2, i2) {\n          row['K' + (i2 + 1)] = o2;\n        });\n        data.push(row);\n      });\n\n      if (data.length > 0) {\n        var wb = XLSX.utils.book_new();\n        var ws = XLSX.utils.json_to_sheet(data);\n        XLSX.utils.book_append_sheet(wb, ws, _this.props.item.sheetName);\n        XLSX.writeFile(wb, _this.props.item.name);\n      }\n    };\n\n    _this.state = {\n      eliminar: false,\n      estadoScript: false\n    };\n    return _this;\n  }\n\n  _createClass(Card, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var item = this.props.item; //name\n\n      var name = 'Sin titulo';\n\n      if (item.name.trim() !== '' && item.name.includes('.')) {\n        var part = item.name.trim().split('.');\n        name = part[0];\n      } //averiguar cuantas keywords tienen resultados\n\n\n      var results = Object.entries(item.keywords).filter(function (_ref5) {\n        var _ref6 = _slicedToArray(_ref5, 2),\n            i = _ref6[0],\n            kw = _ref6[1];\n\n        return kw.results;\n      });\n      var kws = '';\n      Object.entries(item.keywords).forEach(function (_ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            i = _ref8[0],\n            kw = _ref8[1];\n\n        if (kws.length < 300) kws = kws + kw.keyword + \", \";\n      });\n      return React.createElement(\"div\", {\n        className: \"Card2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, name), React.createElement(\"div\", {\n        className: \"display_flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, Object.keys(item.keywords).length, \" Keywords\"), results.length > 0 ? React.createElement(\"span\", {\n        className: \"cloud-ahrefs-keywords \",\n        onClick: function onClick() {\n          return _this2.handleDowload();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(Logo, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }), \"Descargar  \", results.length === Object.keys(item.keywords).length ? '' : '(' + results.length + ')', \" \") : null), React.createElement(\"div\", {\n        className: \"container-kws\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, kws), React.createElement(\"div\", {\n        className: \"toolbar-card-ahrefs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, !this.props.documentScrapingOpera || this.props.documentScrapingOpera.id_document !== item.id_document ? React.createElement(\"div\", {\n        className: \"items-toolbara-ahrefs\",\n        onClick: function onClick() {\n          return _this2.setState({\n            eliminar: true\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Trash, {\n        className: \"btn-ahres-tool trashbutton\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      })) : null, !this.props.documentScrapingOpera && results.length !== Object.keys(item.keywords).length ? React.createElement(\"div\", {\n        onClick: function onClick() {\n          return _this2.goScraping();\n        },\n        className: \"items-toolbara-ahrefs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, React.createElement(Play, {\n        className: \"btn-ahres-tool playbutton item-play-ahref\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      })) : null, this.props.documentScrapingOpera && this.props.documentScrapingOpera.id_document === item.id_document ? React.createElement(\"div\", {\n        className: \"items-toolbara-ahrefs pr status-run-ahrefs-card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(Loop, {\n        className: \"btn-ahres-tool item-running-ahref\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      })) : null, results.length === Object.keys(item.keywords).length ? React.createElement(\"div\", {\n        onClick: function onClick() {\n          return _this2.goScraping();\n        },\n        className: \"items-toolbara-ahrefs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(Check, {\n        className: \"btn-ahres-tool item-check-ahref\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      })) : null), this.state.eliminar ? React.createElement(ConfirmAlert, {\n        text: '¿Estás seguro que deseas eliminar este documento?',\n        cancelar: 'Cancelar',\n        aceptar: 'Eliminar',\n        confirmResult: function confirmResult(result) {\n          return _this2.confirmResult(result);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }) : null);\n    }\n  }]);\n\n  return Card;\n}(Component);\n\nfunction mapStateToProps(state) {\n  return {\n    os: state.global.os,\n    documentScrapingOpera: state.global.documentScrapingOpera\n  };\n}\n\nfunction matchDispatchToProps(dispatch) {\n  return bindActionCreators({\n    setScrapingOpera: setScrapingOpera\n  }, dispatch);\n}\n\nexport default connect(mapStateToProps, matchDispatchToProps)(Card);","map":{"version":3,"sources":["C:\\Users\\Alberto\\Documents\\workspaces\\react\\YOSEO-SCRIPTS\\src\\components\\ContainerApp\\Categorias\\PanelAhrefsKeywords\\Card.js"],"names":["React","Component","ConfirmAlert","connect","bindActionCreators","setScrapingOpera","firebase","XLSX","db","database","ref","window","require","ipcRenderer","Card","props","goScraping","keywords","Object","entries","item","forEach","k","kwd","results","console","log","obj","os","confirmResult","result","setState","eliminar","multiPath","id_document","update","then","catch","err","handleDowload","data","i","o","row","keyword","o2","i2","push","length","wb","utils","book_new","ws","json_to_sheet","book_append_sheet","sheetName","writeFile","name","state","estadoScript","trim","includes","part","split","filter","kw","kws","keys","documentScrapingOpera","mapStateToProps","global","matchDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React,{Component} from 'react'\r\nimport { ReactComponent as Logo } from '../../../Global/Images/download-cloud.svg';\r\nimport { ReactComponent as Play } from '../../../Global/Images/play.svg';\r\nimport { ReactComponent as Loop } from '../../../Global/Images/loop.svg';\r\nimport { ReactComponent as Check } from '../../../Global/Images/check.svg';\r\nimport { ReactComponent as Trash } from '../../../Global/Images/trash.svg';\r\nimport ConfirmAlert from '../../../Global/ConfirmAlert'\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux';\r\nimport { setScrapingOpera } from '../../../../redux/actions';\r\nimport firebase from '../../../../firebase/Firebase';\r\nimport XLSX from 'xlsx';\r\nconst db = firebase.database().ref();\r\nconst { ipcRenderer } = window.require('electron');\r\nclass Card extends Component{\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state={\r\n      eliminar: false,\r\n      estadoScript:false\r\n    }\r\n  }\r\n\r\n  goScraping = () => {\r\n    \r\n    \r\n    var keywords = {}\r\n\r\n    Object.entries(this.props.item.keywords).forEach(([k,kwd])=>{\r\n      \r\n      if(!kwd.results){\r\n        keywords[k]=kwd\r\n      }\r\n    })\r\n\r\n    console.log(keywords);\r\n    \r\n\r\n\r\n\r\n    var obj = {\r\n      item: this.props.item,\r\n      os:this.props.os\r\n    }\r\n    this.props.setScrapingOpera(this.props.item)\r\n    \r\n\r\n\r\n\r\n    //ipcRenderer.send('START_SCRAPING_KEYWORDS_AHREFS', JSON.stringify(obj));\r\n  }\r\n\r\n  confirmResult = (result) => {\r\n    if(result==='cancelar'){\r\n      this.setState({eliminar:false})\r\n    }if(result==='aceptar'){\r\n      var multiPath = {}\r\n      multiPath[`Others/apps/scraping/keywords-explorer-ahrefs/documents/${this.props.item.id_document}`]=null\r\n      db.update(multiPath)\r\n      .then(()=>{\r\n        this.setState({eliminar:false})\r\n      })\r\n      .catch(err=>{\r\n        console.log(err);\r\n      })\r\n      \r\n    }\r\n\r\n  }\r\n\r\n  handleDowload = () => {\r\n    var data = [];\r\n    Object.entries(this.props.item.keywords).forEach(([i,o])=>{\r\n      var row = {};\r\n      row['KEYWORD']= o.keyword;\r\n      o.results.forEach((o2,i2)=>{\r\n        row['K'+(i2+1)]=o2\r\n      })\r\n      data.push(row)\r\n    })\r\n    \r\n    if(data.length>0){\r\n      var wb = XLSX.utils.book_new();\r\n      var ws = XLSX.utils.json_to_sheet(data);\r\n      XLSX.utils.book_append_sheet(wb, ws, this.props.item.sheetName);\r\n      XLSX.writeFile(wb, this.props.item.name);\r\n    }\r\n    \r\n  }\r\n\r\n  render(){\r\n    var item = this.props.item;\r\n    \r\n    //name\r\n    var name = 'Sin titulo'\r\n    if (item.name.trim() !== '' && item.name.includes('.')) {\r\n      var part = item.name.trim().split('.')\r\n      name = part[0]\r\n    }\r\n\r\n    //averiguar cuantas keywords tienen resultados\r\n    var results = Object.entries(item.keywords).filter(([i, kw]) => { return kw.results });\r\n\r\n    var kws = ''\r\n    Object.entries(item.keywords).forEach(([i, kw]) => {\r\n      if (kws.length < 300)\r\n        kws = kws + kw.keyword + \", \"\r\n    });\r\n\r\n    return (\r\n      <div className='Card2' >\r\n        <h2>{name}</h2>\r\n        <div className='display_flex'>\r\n          <p>{Object.keys(item.keywords).length} Keywords</p>\r\n          {results.length>0?\r\n            <span className='cloud-ahrefs-keywords ' onClick={()=>this.handleDowload()}>\r\n              <Logo />\r\n              Descargar  {results.length===Object.keys(item.keywords).length?'':'('+results.length+')'} </span>\r\n          :null}\r\n          \r\n        </div>\r\n        <div className='container-kws'>\r\n          {kws}\r\n        </div>\r\n\r\n        <div className='toolbar-card-ahrefs'>\r\n          {!this.props.documentScrapingOpera || this.props.documentScrapingOpera.id_document!==item.id_document?<div className='items-toolbara-ahrefs' onClick={()=>this.setState({eliminar:true})}><Trash className='btn-ahres-tool trashbutton' /></div>:null}\r\n          \r\n          { (!this.props.documentScrapingOpera && results.length!==Object.keys(item.keywords).length) ?\r\n            <div onClick={()=>this.goScraping()} className='items-toolbara-ahrefs'><Play className='btn-ahres-tool playbutton item-play-ahref' /></div>:null\r\n          }\r\n\r\n          { this.props.documentScrapingOpera && this.props.documentScrapingOpera.id_document===item.id_document ?\r\n            <div className='items-toolbara-ahrefs pr status-run-ahrefs-card'>\r\n              <Loop className='btn-ahres-tool item-running-ahref' />\r\n              {/*<Stop className='btn-ahres-tool item-stop-ahrefs' />*/}\r\n            </div>:null\r\n          }\r\n\r\n          { results.length===Object.keys(item.keywords).length ?\r\n            <div onClick={()=>this.goScraping()} className='items-toolbara-ahrefs'><Check className='btn-ahres-tool item-check-ahref' /></div>:null\r\n          }\r\n        </div>\r\n\r\n        {this.state.eliminar ?\r\n          <ConfirmAlert\r\n            text={'¿Estás seguro que deseas eliminar este documento?'}\r\n            cancelar={'Cancelar'}\r\n            aceptar={'Eliminar'}\r\n            confirmResult={(result) => this.confirmResult(result)}\r\n          /> : null\r\n        }\r\n        \r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nfunction mapStateToProps(state) {return {os:state.global.os, documentScrapingOpera: state.global.documentScrapingOpera}}\r\nfunction matchDispatchToProps(dispatch) { return bindActionCreators({ setScrapingOpera }, dispatch)}\r\nexport default connect(mapStateToProps, matchDispatchToProps)(Card);"]},"metadata":{},"sourceType":"module"}