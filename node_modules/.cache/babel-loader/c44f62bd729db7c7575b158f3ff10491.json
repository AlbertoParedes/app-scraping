{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alberto\\\\Documents\\\\workspaces\\\\react\\\\YOSEO-SCRIPTS\\\\src\\\\components\\\\ContainerApp\\\\Categorias\\\\PanelWord2Html\\\\Word2Html.js\";\nimport React, { Component } from \"react\";\nimport moment from 'moment';\nimport WordButton from './WordButton';\nimport format from 'xml-formatter';\nimport convert from 'xml-js';\nimport firebase from '../../../../firebase/Firebase';\nimport XLSX from 'xlsx';\nimport ReactHtmlParser from 'react-html-parser';\nimport { ReactComponent as Trash } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/trash.svg\";\nimport { ReactComponent as Cross } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/add_circle.svg\";\nimport { ReactComponent as Code } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/code.svg\";\nimport { ReactComponent as Image } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/image.svg\";\nimport { ReactComponent as Loop } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/loop.svg\";\nimport { ReactComponent as Save } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/save-alt.svg\";\nimport { ReactComponent as Reset } from \"@svgr/webpack?-svgo,+ref!../../../Global/Images/thumb_up.svg\";\nvar db = firebase.database().ref();\n\nvar _window$require = window.require('electron'),\n    ipcRenderer = _window$require.ipcRenderer;\n\nvar Word2Html =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Word2Html, _Component);\n\n  function Word2Html(props) {\n    var _this;\n\n    _classCallCheck(this, Word2Html);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Word2Html).call(this, props));\n\n    _this.componentWillReceiveProps = function (newProps) {\n      if (_this.state.visibility !== newProps.visibility) {\n        if (!_this.state.getData) {\n          _this.setState({\n            visibility: newProps.visibility,\n            getData: true\n          }, function () {\n            _this.getData();\n          });\n        } else {\n          _this.setState({\n            visibility: newProps.visibility\n          });\n        }\n      }\n    };\n\n    _this.componentWillMount = function () {\n      ipcRenderer.removeListener('RESPONSE_UPLOAD_WORDS', _this.updateMessage);\n    };\n\n    _this.componentDidMount = function () {\n      ipcRenderer.on('RESPONSE_UPLOAD_WORDS', _this.updateMessage);\n    };\n\n    _this.updateMessage = function (event, files) {\n      var allIds = {};\n      files.forEach(function (file, i) {\n        _this.getId(allIds, file, i);\n      });\n      var arrayFiles = files;\n      files.sort(function (a, b) {\n        if (a.id > b.id) {\n          return 1;\n        }\n\n        if (a.id < b.id) {\n          return -1;\n        }\n      });\n\n      _this.setState({\n        arrayFiles: arrayFiles,\n        filesOrdenados: files,\n        allIds: allIds,\n        statusScript: 'guardar'\n      });\n    };\n\n    _this.getId = function (allIds, file, index) {\n      var id = -1;\n\n      if (file.name.length > 0) {\n        try {\n          for (var i = 0; i <= file.name.length; i++) {\n            if (!isNaN(file.name.substring(0, i + 1))) {\n              id = file.name.substring(0, i + 1);\n            }\n          }\n        } catch (error) {}\n\n        if (id !== -1) {\n          var name = file.name.substring(id.length, file.name.length);\n\n          for (var j = 0; j < name.length; j++) {\n            var c = name.charAt(j);\n\n            if (c.toUpperCase() !== c.toLowerCase()) {\n              //si entra en este if significa que hemos encontrado la primera letra, por lo que habra que salir del for\n              name = name.substring(j, name.length);\n              j = name.length;\n            }\n          }\n\n          file.name = name.trim();\n        }\n      }\n\n      file.id = +id; //guardar en allIds\n\n      if (!allIds[+id]) {\n        allIds[+id] = [];\n      }\n\n      file.id_array = index;\n      allIds[+id].push({\n        name: file.name,\n        index: index\n      });\n    };\n\n    _this.getData = function () {//console.log('getting data...');\n    };\n\n    _this.getFiles = function (files) {\n      /*var obj = {\r\n        files: files\r\n      }\r\n      */\n      //ipcRenderer.send('GET_DATA_WORDS', JSON.stringify(obj));\n      if (files.length > 0) {\n        _this.setState({\n          statusScript: 'running'\n        }, function () {\n          ipcRenderer.send('GET_DATA_WORDS', files);\n        });\n      }\n    };\n\n    _this.saveDownload = function (e) {\n      var files = e.target.files;\n\n      if (files && files[0]) {\n        var pathDownload = files[0].path;\n        ipcRenderer.send('SAVE_DATA_WORDS', {\n          path: pathDownload,\n          files: _this.state.filesOrdenados\n        });\n      }\n\n      document.getElementById('fileselector-w2h').value = '';\n    };\n\n    _this.resetAll = function () {\n      _this.setState({\n        recentDocuemts: {},\n        arrayFiles: [],\n        filesOrdenados: [],\n        allIds: {},\n        openCode: false,\n        showImages: false,\n        statusScript: 'run'\n      });\n    };\n\n    _this.openCode = function (file) {\n      if (_this.state.openCode && _this.state.openCode.id_array === file.id_array) {\n        _this.setState({\n          openCode: false,\n          showImages: false\n        });\n      } else {\n        _this.setState({\n          openCode: file,\n          showImages: false\n        });\n      }\n    };\n\n    _this.showImages = function (file) {\n      if (_this.state.showImages && _this.state.showImages.id_array === file.id_array) {\n        _this.setState({\n          openCode: false,\n          showImages: false\n        });\n      } else {\n        _this.setState({\n          openCode: false,\n          showImages: file\n        });\n      }\n    };\n\n    _this.deleteItem = function (id) {\n      var filesOrdenados = _this.state.filesOrdenados;\n      filesOrdenados.splice(id, id + 1);\n\n      _this.setState({\n        filesOrdenados: filesOrdenados\n      });\n    };\n\n    _this.deleteImage = function (id_image, id_array) {\n      //console.log(id, file);\n      var filesOrdenados = _this.state.filesOrdenados; //filesOrdenados[id_array].images.length = filesOrdenados[id_array].images.length - 1\n      //delete filesOrdenados[id_array].images[id_image]\n\n      filesOrdenados[id_array].html = filesOrdenados[id_array].html.replace(\"<img src=\\\"\".concat(filesOrdenados[id_array].images[id_image], \"\\\" />\"), \"\");\n      filesOrdenados[id_array].images.splice(id_image, id_image + 1);\n\n      _this.setState({\n        filesOrdenados: filesOrdenados\n      });\n    };\n\n    _this.state = {\n      documents: {},\n      visibility: _this.props.visibility,\n      getData: false,\n      styleImage: {\n        background: \"linear-gradient(95.65deg, rgb(22, 26, 57) 13.2%, rgba(22, 26, 57, 0.9) 55.88%, rgba(39, 39, 72, 0.35) 97.88%) center center / cover, url(\".concat(_this.props.app.image, \") no-repeat\"),\n        backgroundPosition: \"center center\",\n        transition: 'transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) 0s',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        top: '0px',\n        left: '0px'\n      },\n      recentDocuemts: {},\n      arrayFiles: [],\n      filesOrdenados: [],\n      allIds: {},\n      openCode: false,\n      showImages: false,\n      statusScript: 'run'\n    };\n    return _this;\n  }\n\n  _createClass(Word2Html, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (!this.state.visibility) return false;\n      return React.createElement(\"div\", {\n        className: \"home-app\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-type1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"img-container-panel\",\n        style: this.state.styleImage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"pr\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, this.props.app.titlePanel), React.createElement(\"div\", {\n        className: \"container-tools-ahrefs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"subtitle-container-principal\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, this.state.filesOrdenados.length, \" \", this.state.filesOrdenados.length === 1 ? 'DOCUMENTO' : 'DOCUMENTOS')), React.createElement(\"div\", {\n        className: \"text-explicativo-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, this.props.app.desciption)), React.createElement(\"div\", {\n        className: \"container-buttons-panel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, this.state.statusScript === 'run' ? React.createElement(WordButton, {\n        getFiles: function getFiles(files) {\n          return _this2.getFiles(files);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }) : null, this.state.statusScript === 'running' ? React.createElement(\"div\", {\n        className: \"btn-w2a-option running-w2h\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"displa_flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(Loop, {\n        className: \"loop-prensarank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"text-btn-prensarank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, \"Convirtiendo...\"))) : null, this.state.statusScript === 'guardar' ? React.createElement(\"div\", {\n        className: \"btn-w2a-option btn-w2a-save\",\n        onClick: function onClick(e) {\n          document.getElementById('fileselector-w2h').click();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"displa_flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(Save, {\n        className: \"save-w2h\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"text-btn-prensarank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, \"Guardar resultados\")), React.createElement(\"input\", {\n        id: \"fileselector-w2h\",\n        type: \"file\",\n        onChange: function onChange(e) {\n          _this2.saveDownload(e);\n        },\n        webkitdirectory: 'true',\n        directory: 'true',\n        multiple: 'true',\n        style: {\n          display: 'none'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      })) : null, this.state.statusScript === 'guardar' ? React.createElement(\"div\", {\n        className: \"btn-w2a-option btn-reset-w2h\",\n        onClick: function onClick(e) {\n          _this2.resetAll();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"displa_flex center-block height_100\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, React.createElement(Reset, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }))) : null)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, this.state.filesOrdenados.length > 0 ? this.state.filesOrdenados.map(function (f, i) {\n        return React.createElement(\"div\", {\n          className: \"item-word-result\",\n          key: i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 249\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"display_flex\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 250\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"w2h-id \".concat(f.id === -1 ? 'wrong-id' : '', \" \").concat(_this2.state.allIds[f.id] && _this2.state.allIds[f.id].length > 1 ? 'repeat-id-w2h' : '', \" \"),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 252\n          },\n          __self: this\n        }, f.id !== -1 ? f.id : '✖'), React.createElement(\"div\", {\n          className: \"w2h-text\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 254\n          },\n          __self: this\n        }, f.name.replace('.docx', '')), React.createElement(\"div\", {\n          className: \"tools-w2h\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 255\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"center-block code-row-w2h\",\n          onClick: function onClick() {\n            return _this2.openCode(f);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 256\n          },\n          __self: this\n        }, React.createElement(Code, {\n          className: \"\".concat(_this2.state.openCode && _this2.state.openCode.id_array === f.id_array ? 'open-icon' : ''),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 256\n          },\n          __self: this\n        })), f.images && f.images.length > 0 ? React.createElement(\"div\", {\n          className: \"center-block image-row-w2h\",\n          onClick: function onClick() {\n            return _this2.showImages(f);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258\n          },\n          __self: this\n        }, React.createElement(Image, {\n          className: \"\".concat(_this2.state.showImages && _this2.state.showImages.id_array === f.id_array ? 'open-icon' : '', \" \").concat(f.images.length > 1 ? 'more-image-error' : ''),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258\n          },\n          __self: this\n        })) : null, React.createElement(\"div\", {\n          className: \"center-block trash-row-w2h\",\n          onClick: function onClick() {\n            return _this2.deleteItem(i);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261\n          },\n          __self: this\n        }, React.createElement(Trash, {\n          className: \"trash-row-w2h\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261\n          },\n          __self: this\n        })))), _this2.state.openCode && _this2.state.openCode.id_array === f.id_array ? React.createElement(\"div\", {\n          className: \"html-w2a-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268\n          },\n          __self: this\n        }, ReactHtmlParser(_this2.state.openCode.html))) : null, f.images && f.images.length > 0 && _this2.state.showImages && _this2.state.showImages.id_array === f.id_array ? React.createElement(\"div\", {\n          className: \"html-w2a-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 276\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277\n          },\n          __self: this\n        }, _this2.state.showImages.images.map(function (s, k) {\n          return React.createElement(\"div\", {\n            key: k,\n            className: \"img-w2h-delete\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 281\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"icon-delete-image-w2h\",\n            onClick: function onClick() {\n              return _this2.deleteImage(k, i);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 282\n            },\n            __self: this\n          }, React.createElement(Cross, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 282\n            },\n            __self: this\n          })), React.createElement(\"img\", {\n            src: s,\n            alt: \"\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 283\n            },\n            __self: this\n          }));\n        }))) : null);\n      }) : null));\n    }\n  }]);\n\n  return Word2Html;\n}(Component);\n\nexport default Word2Html;","map":{"version":3,"sources":["C:\\Users\\Alberto\\Documents\\workspaces\\react\\YOSEO-SCRIPTS\\src\\components\\ContainerApp\\Categorias\\PanelWord2Html\\Word2Html.js"],"names":["React","Component","moment","WordButton","format","convert","firebase","XLSX","ReactHtmlParser","db","database","ref","window","require","ipcRenderer","Word2Html","props","componentWillReceiveProps","newProps","state","visibility","getData","setState","componentWillMount","removeListener","updateMessage","componentDidMount","on","event","files","allIds","forEach","file","i","getId","arrayFiles","sort","a","b","id","filesOrdenados","statusScript","index","name","length","isNaN","substring","error","j","c","charAt","toUpperCase","toLowerCase","trim","id_array","push","getFiles","send","saveDownload","e","target","pathDownload","path","document","getElementById","value","resetAll","recentDocuemts","openCode","showImages","deleteItem","splice","deleteImage","id_image","html","replace","images","documents","styleImage","background","app","image","backgroundPosition","transition","position","width","height","top","left","titlePanel","desciption","click","display","map","f","s","k"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport moment from 'moment'\r\nimport WordButton from './WordButton'\r\n\r\nimport format from 'xml-formatter'\r\nimport convert from'xml-js';\r\nimport firebase from '../../../../firebase/Firebase';\r\nimport XLSX from 'xlsx';\r\nimport ReactHtmlParser from 'react-html-parser'; \r\nimport { ReactComponent as Trash } from '../../../Global/Images/trash.svg';\r\nimport { ReactComponent as Cross } from '../../../Global/Images/add_circle.svg';\r\nimport { ReactComponent as Code } from '../../../Global/Images/code.svg';\r\nimport { ReactComponent as Image } from '../../../Global/Images/image.svg';\r\nimport { ReactComponent as Loop } from '../../../Global/Images/loop.svg';\r\nimport { ReactComponent as Save } from '../../../Global/Images/save-alt.svg';\r\nimport { ReactComponent as Reset } from '../../../Global/Images/thumb_up.svg';\r\nconst db = firebase.database().ref();\r\n\r\nconst { ipcRenderer } = window.require('electron');\r\n\r\nclass Word2Html extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      documents: {},\r\n      visibility:this.props.visibility,\r\n      getData:false,      \r\n      styleImage:{\r\n        background:`linear-gradient(95.65deg, rgb(22, 26, 57) 13.2%, rgba(22, 26, 57, 0.9) 55.88%, rgba(39, 39, 72, 0.35) 97.88%) center center / cover, url(${this.props.app.image}) no-repeat`,\r\n        backgroundPosition: \"center center\",\r\n        transition: 'transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) 0s',\r\n        position: 'absolute',\r\n        width: '100%',\r\n        height: '100%',\r\n        top: '0px',\r\n        left: '0px'\r\n      },\r\n      recentDocuemts:{},\r\n      arrayFiles:[],\r\n      filesOrdenados:[],\r\n      allIds:{},\r\n      openCode:false,\r\n      showImages:false,\r\n      statusScript:'run'\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps = newProps => {\r\n    if(this.state.visibility!==newProps.visibility){\r\n      if(!this.state.getData){\r\n        this.setState({visibility:newProps.visibility,getData:true},()=>{\r\n          this.getData()\r\n        })\r\n      }else{\r\n        this.setState({visibility:newProps.visibility})\r\n      }\r\n    }\r\n  }\r\n\r\n  componentWillMount = () => {\r\n    ipcRenderer.removeListener('RESPONSE_UPLOAD_WORDS',this.updateMessage);\r\n  }\r\n  componentDidMount = () => {\r\n    ipcRenderer.on('RESPONSE_UPLOAD_WORDS',this.updateMessage);\r\n  }\r\n  updateMessage = (event, files) => {\r\n\r\n    var allIds = {}\r\n    files.forEach((file,i)=>{\r\n      this.getId(allIds,file,i)\r\n    })\r\n\r\n    const arrayFiles = files\r\n\r\n    files.sort((a, b) => {\r\n      if (a.id > b.id) { return 1; }\r\n      if (a.id < b.id) { return -1;}\r\n    })\r\n\r\n    this.setState({arrayFiles,filesOrdenados:files, allIds, statusScript:'guardar'})\r\n\r\n  }\r\n\r\n  getId = (allIds, file,index) =>{\r\n    var id = -1;\r\n    if(file.name.length>0){\r\n      try {\r\n        for(var i=0;i<=file.name.length;i++){\r\n          if(!isNaN(file.name.substring(0,i+1))){\r\n            id=file.name.substring(0,i+1);\r\n          }\r\n        }\r\n      } catch (error) {}\r\n\r\n      if(id!==-1){\r\n        var name = file.name.substring(id.length,file.name.length);\r\n        for(var j=0;j<name.length;j++){\r\n          var c = name.charAt(j);\r\n          if( c.toUpperCase() !== c.toLowerCase() ){\r\n            //si entra en este if significa que hemos encontrado la primera letra, por lo que habra que salir del for\r\n            name = name.substring(j,name.length)\r\n            j=name.length\r\n          }\r\n        }\r\n        file.name = name.trim()\r\n      }\r\n    }\r\n    file.id = (+id)\r\n    //guardar en allIds\r\n    if(!allIds[(+id)]){\r\n      allIds[(+id)] = []\r\n    }\r\n    file.id_array=index\r\n    allIds[(+id)].push({name:file.name, index})\r\n  }\r\n\r\n\r\n  getData = () => {\r\n    //console.log('getting data...');\r\n  }\r\n\r\n  getFiles = files =>{\r\n    /*var obj = {\r\n      files: files\r\n    }\r\n    */\r\n    //ipcRenderer.send('GET_DATA_WORDS', JSON.stringify(obj));\r\n    if(files.length>0){\r\n      this.setState({\r\n        statusScript:'running'\r\n      },()=>{\r\n        ipcRenderer.send('GET_DATA_WORDS', files);\r\n      })\r\n    }\r\n    \r\n  }\r\n\r\n  saveDownload = e => {\r\n    const files = e.target.files;\r\n    if (files && files[0]){\r\n      var pathDownload = files[0].path\r\n      ipcRenderer.send('SAVE_DATA_WORDS', {path:pathDownload,files:this.state.filesOrdenados});\r\n    }\r\n    \r\n    document.getElementById('fileselector-w2h').value = ''\r\n    \r\n  }\r\n\r\n  resetAll = () => {\r\n    this.setState({\r\n      recentDocuemts:{},\r\n      arrayFiles:[],\r\n      filesOrdenados:[],\r\n      allIds:{},\r\n      openCode:false,\r\n      showImages:false,\r\n      statusScript:'run'\r\n    })\r\n  }\r\n\r\n  openCode = (file) =>{\r\n    if(this.state.openCode && this.state.openCode.id_array===file.id_array){\r\n      this.setState({ openCode: false, showImages:false })\r\n    }else{\r\n      this.setState({ openCode: file, showImages:false })\r\n    }\r\n  }\r\n\r\n  showImages = file => {\r\n    if(this.state.showImages && this.state.showImages.id_array===file.id_array){\r\n      this.setState({ openCode: false, showImages:false })\r\n    }else{\r\n      this.setState({ openCode: false, showImages: file})\r\n    }\r\n  }\r\n\r\n  deleteItem = id => {\r\n    var filesOrdenados = this.state.filesOrdenados;\r\n    filesOrdenados.splice(id, id+1)\r\n    this.setState({filesOrdenados})\r\n  }\r\n  deleteImage = (id_image, id_array) =>{\r\n    //console.log(id, file);\r\n    var filesOrdenados = this.state.filesOrdenados;\r\n    //filesOrdenados[id_array].images.length = filesOrdenados[id_array].images.length - 1\r\n    //delete filesOrdenados[id_array].images[id_image]\r\n    filesOrdenados[id_array].html = filesOrdenados[id_array].html.replace(`<img src=\"${filesOrdenados[id_array].images[id_image]}\" />`,``)\r\n    filesOrdenados[id_array].images.splice(id_image, id_image+1)\r\n    this.setState({filesOrdenados})\r\n  }\r\n   \r\n\r\n  render() {\r\n\r\n    if(!this.state.visibility)return false\r\n    return (\r\n      <div className='home-app' >\r\n\r\n        <div  className='container-type1' >\r\n          <div className='img-container-panel' style={this.state.styleImage}></div>\r\n          <div className='pr'>\r\n            <h1>{this.props.app.titlePanel}</h1>\r\n            <div className='container-tools-ahrefs'>\r\n              <p className='subtitle-container-principal'>{this.state.filesOrdenados.length} {this.state.filesOrdenados.length===1?'DOCUMENTO':'DOCUMENTOS'}</p>\r\n            </div>\r\n            <div className='text-explicativo-container'>{this.props.app.desciption}</div>\r\n          </div>\r\n          <div className='container-buttons-panel'>\r\n         \r\n            {this.state.statusScript==='run'?<WordButton getFiles={files=>this.getFiles(files)} />:null}\r\n\r\n            {this.state.statusScript==='running'?\r\n              <div className={`btn-w2a-option running-w2h`}>\r\n                <div className='displa_flex'>\r\n                  <Loop className='loop-prensarank' />\r\n                  <div className='text-btn-prensarank'>Convirtiendo...</div>\r\n                </div>\r\n              </div>:null\r\n            }\r\n            \r\n            {this.state.statusScript==='guardar'?\r\n              <div className={`btn-w2a-option btn-w2a-save`} onClick={(e)=>{document.getElementById('fileselector-w2h').click()}}>\r\n                <div className='displa_flex'>\r\n                  <Save className='save-w2h' />\r\n                  <div className='text-btn-prensarank'>Guardar resultados</div>\r\n                </div>\r\n                <input id=\"fileselector-w2h\" type=\"file\"  onChange={(e)=>{this.saveDownload(e)}} webkitdirectory={'true'} directory={'true'} multiple={'true'} style={{display:'none'}} />\r\n              </div>:null\r\n            }\r\n\r\n            {this.state.statusScript==='guardar'?\r\n              <div className={`btn-w2a-option btn-reset-w2h`} onClick={(e)=>{this.resetAll()}}>\r\n                <div className='displa_flex center-block height_100'>\r\n                  <Reset  />\r\n                </div>\r\n              </div>\r\n            :null}\r\n           </div>\r\n          \r\n        </div>\r\n\r\n        <div>\r\n\r\n          {this.state.filesOrdenados.length>0?\r\n\r\n            this.state.filesOrdenados.map((f,i)=>{\r\n              \r\n              return(\r\n                <div className={`item-word-result`} key={i}>\r\n                  <div className='display_flex'>\r\n\r\n                    <div className={`w2h-id ${f.id===-1?'wrong-id':''} ${this.state.allIds[f.id] && this.state.allIds[f.id].length>1?'repeat-id-w2h':''} `}>{f.id!==-1?f.id:'✖'}</div>\r\n\r\n                    <div className='w2h-text'>{f.name.replace('.docx','')}</div>\r\n                    <div className={`tools-w2h`}>\r\n                      <div className='center-block code-row-w2h' onClick={()=>this.openCode(f)} ><Code className={`${this.state.openCode && this.state.openCode.id_array===f.id_array?'open-icon':''}`} /></div>\r\n                      {f.images && f.images.length>0?\r\n                        <div className='center-block image-row-w2h' onClick={()=>this.showImages(f)} ><Image className={`${this.state.showImages && this.state.showImages.id_array===f.id_array?'open-icon':''} ${f.images.length>1?'more-image-error':''}`} /></div>\r\n                      :null\r\n                      }\r\n                      <div className='center-block trash-row-w2h' onClick={()=>this.deleteItem(i)} ><Trash className='trash-row-w2h' /></div>\r\n                    </div>\r\n\r\n                  </div>\r\n\r\n                  {this.state.openCode && this.state.openCode.id_array===f.id_array?\r\n                    <div className='html-w2a-container'>\r\n                      <div>\r\n                        {ReactHtmlParser(this.state.openCode.html)}\r\n                      </div>\r\n                    </div>\r\n                    :null\r\n                  }\r\n\r\n                  {f.images && f.images.length>0 && this.state.showImages && this.state.showImages.id_array===f.id_array?\r\n                    <div className='html-w2a-container'>\r\n                      <div>\r\n                        {\r\n                          this.state.showImages.images.map((s,k)=>{\r\n                            return(\r\n                              <div key={k} className='img-w2h-delete'>\r\n                                <div className='icon-delete-image-w2h' onClick={()=>this.deleteImage(k,i)} ><Cross /></div>\r\n                                <img src={s} alt=\"\"/>\r\n                              </div>\r\n                            )\r\n                          })\r\n                        }\r\n                      </div>\r\n                    </div>\r\n                    :null\r\n                  }\r\n\r\n\r\n                </div>\r\n              )\r\n            }):null\r\n\r\n          }\r\n\r\n\r\n        </div>\r\n\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n\r\n\r\nexport default Word2Html;"]},"metadata":{},"sourceType":"module"}